<!DOCTYPE html>
{% autoescape true %}
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>Lychee</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Free medicine delivery anytime, anywhere">

  <!-- Font Awesome -->
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- Google Font -->
  <link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
  <!-- Bootstrap -->
  <link href="./css/bootstrap.min.css" rel="stylesheet" media="screen">
  <link href="./css/style.css" rel="stylesheet" media="screen">
  <link rel='stylesheet' href='./calendar/fullcalendar.css' />
  <script src='./javascript/jquery.min.js'></script>
  <script src='./javascript/moment.min.js'></script>
  <script src='./calendar/fullcalendar.js'></script>
  <script src="./javascript/typed.js"></script>
  <script src="./javascript/bootstrap.min.js"></script>
  <script src="./javascript/typed.js"></script>
  <script>
    $(document).ready(function() {

      // page is now ready, initialize the calendar...

      $('#calendar').fullCalendar({
        // put your options and callbacks here
        selectable: true,
        selectHelper: true,
        select: function(start, end) {
          title = "this player";
          if (title) {
            eventData = {
              id: 5123252,
              title: title,
              start: start,
              end: end
            };
            $('#calendar').fullCalendar('renderEvent', eventData, true);
          }
          $('#calendar').fullCalendar('unselect');
          document.getElementById("player").innerHTML = eventData.title;
          document.getElementById("start_time").innerHTML = eventData.start;
          document.getElementById("end_time").innerHTML = eventData.end;
        }
      })
    });

    function showEventsOnCalendar() {
      var json_str = '\
      [\
        {\
            "players":["Abhi", "Shengwei", "Ruofeng", "Allen", "Tony"],\
            "start":"Thu Aug 14 2014 09:15:00 GMT+0000",\
            "end":"Thu Aug 14 2014 10:10:00 GMT+0000"\
        },\
        {\
            "players":["Abhi", "Allen", "Tony"],\
            "start":"Thu Aug 14 2014 13:45:00 GMT+0000",\
            "end":"Thu Aug 14 2014 14:10:00 GMT+0000"\
        }\
      ]\
      '
      var events = JSON.parse(json_str);
      console.log(events.length);
      for (var i=0; i<events.length; i++) {
        var title = "";
        for (var j=0; j<events[i].players.length; j++) {
          title = title.concat(events[i].players[j]);
          title = title.concat(", ")
        }
        title = title.substring(0, title.length-2);
        eventData = {
          title: title,
          start: events[i].start,
          end: events[i].end
        };
        $('#calendar').fullCalendar('renderEvent', eventData, true);
      }
      // document.getElementById("player").innerHTML = events[0];
    }

    function cancel() {
      $('#calendar').fullCalendar('removeEvents', eventData.id);
    }
    function done() {
      // add something to title 
      // eventData.title = ...
      $('#calendar').fullCalendar('updateEvent', eventData);
    }
  </script>
  <style>

  body {
    margin: 0;
    padding: 0;
    font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
    font-size: 14px;
  }

  #calendar {
    width: 500px;
    margin: 40px auto;
  }

  </style>

<script>
    function setCookie() {
        document.cookie = document.getElementById("input_name").value;
        document.getElementById("player_name").innerHTML = document.getElementById("input_name").value;
        //document.cookie = "jsw";
        checkCookie();
    }
    function getCookie() {
        return document.cookie;
    }
    function checkCookie() {
        var username = getCookie();
        if (username != "") {
            showPlayerName(username);
        } else {
            showLogin();
        }
    }
    function showPlayerName(pname) {
        var player = pname;
        document.getElementById("player_name").innerHTML = player;
    }
    function showLogin() {
    }
</script>

<script>
    function load() {
        showEventsOnCalendar();
        checkCookie();
    }
</script>

</head>
<body onload="load()">
    <input id="input_name" type="text" name="Name"></input>
    <input type="submit" onclick="setCookie()"></input>
    <p id="player_name">none</p>
  <div class="container">
    <div id='calendar' style="background-color:#FFD700;height:800px;width:400px;float:left;"></div>
    <div id="info" style="background-color:#EEEEEE;height:400px;width:400px;float:left;">
      <div id="player"></div>
      <div id="start_time"></div>
      <div id="end_time"></div>
      <button onclick="cancel()">Cancel</button>
      <button onclick="done()">DONE!</button>
    </div>
  </div>
  </body>
</html>
{% endautoescape %}
